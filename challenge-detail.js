// Challenge Detail System with Requirements and Instructions
class ChallengeDetail {
    constructor() {
        this.challengeId = this.getChallengeIdFromURL();
        this.category = this.getCategoryFromURL();
        this.challengeData = this.loadChallengeData();
        
        this.initializeElements();
        this.loadChallengeDetails();
        this.bindEvents();
    }
    
    // Get challenge ID from URL parameters
    getChallengeIdFromURL() {
        const params = new URLSearchParams(window.location.search);
        return parseInt(params.get('id')) || 1;
    }
    
    // Get category from URL parameters
    getCategoryFromURL() {
        const params = new URLSearchParams(window.location.search);
        return params.get('category') || 'html-basics';
    }
    
    // Initialize DOM elements
    initializeElements() {
        this.backBtn = document.getElementById('back-to-challenges');\n        this.challengeTitle = document.getElementById('challenge-title');\n        this.difficultyBadge = document.getElementById('difficulty-badge');\n        this.xpBadge = document.getElementById('xp-badge');\n        this.categoryBadge = document.getElementById('category-badge');\n        this.challengeDescription = document.getElementById('challenge-description');\n        this.requirementsList = document.getElementById('requirements-list');\n        this.showHintBtn = document.getElementById('show-hint');\n        this.hintContent = document.getElementById('hint-content');\n        this.examplePreview = document.getElementById('example-preview');\n        this.starterHtml = document.getElementById('starter-html');\n        this.starterCss = document.getElementById('starter-css');\n        this.starterJs = document.getElementById('starter-js');\n        this.copyStarterBtn = document.getElementById('copy-starter');\n        this.challengeProgress = document.getElementById('challenge-progress');\n        this.startChallengeBtn = document.getElementById('start-challenge');\n        this.skipChallengeBtn = document.getElementById('skip-challenge');\n        this.startCodingBtn = document.getElementById('start-coding');\n    }\n    \n    // Load challenge data from localStorage\n    loadChallengeData() {\n        const saved = localStorage.getItem('codequest_challenges');\n        return saved ? JSON.parse(saved) : {};\n    }\n    \n    // Define detailed challenge requirements and instructions\n    getChallengeDetails() {\n        const challengeDetails = {\n            'html-basics': {\n                1: {\n                    title: 'Basic HTML Structure',\n                    description: 'Create a complete HTML document with proper structure including DOCTYPE, html, head, and body elements.',\n                    requirements: [\n                        'Include DOCTYPE html declaration',\n                        'Create html element with lang attribute',\n                        'Add head section with title element',\n                        'Include body section with content',\n                        'Use proper indentation and formatting'\n                    ],\n                    hints: [\n                        'Start with <!DOCTYPE html>',\n                        'Remember to set the language attribute: <html lang=\"en\">',\n                        'The title appears in the browser tab'\n                    ],\n                    example: 'A basic webpage with \"Hello World\" heading and paragraph',\n                    starterCode: {\n                        html: '<!-- Create your HTML structure here -->',\n                        css: '/* Add your styles here */',\n                        js: '// Add your JavaScript here'\n                    }\n                },\n                2: {\n                    title: 'Headings and Paragraphs',\n                    description: 'Use different heading levels (h1-h6) and paragraph elements to create a structured document.',\n                    requirements: [\n                        'Use at least 3 different heading levels (h1, h2, h3)',\n                        'Include multiple paragraph elements',\n                        'Maintain proper heading hierarchy',\n                        'Add meaningful content to each element'\n                    ],\n                    hints: [\n                        'h1 should be used for main title',\n                        'Use h2 for section headings, h3 for subsections',\n                        'Paragraphs should contain complete sentences'\n                    ],\n                    example: 'A blog post structure with main title, section headings, and paragraphs',\n                    starterCode: {\n                        html: '<h1>Main Title</h1>\\n<!-- Add more headings and paragraphs -->',\n                        css: 'h1 { color: #333; }',\n                        js: '// No JavaScript needed for this challenge'\n                    }\n                }\n            },\n            'css-styling': {\n                1: {\n                    title: 'Basic CSS Selectors',\n                    description: 'Apply styles using element, class, and ID selectors to create a visually appealing webpage.',\n                    requirements: [\n                        'Use element selectors to style HTML tags',\n                        'Create and use at least 2 CSS classes',\n                        'Use at least 1 ID selector',\n                        'Apply colors, fonts, and spacing',\n                        'Ensure good visual hierarchy'\n                    ],\n                    hints: [\n                        'Element selector: h1 { }',\n                        'Class selector: .my-class { }',\n                        'ID selector: #my-id { }'\n                    ],\n                    example: 'A styled webpage with different colors, fonts, and spacing',\n                    starterCode: {\n                        html: '<h1 id=\"main-title\">Welcome</h1>\\n<p class=\"intro\">Introduction paragraph</p>',\n                        css: '/* Add your CSS selectors and styles here */',\n                        js: '// No JavaScript needed'\n                    }\n                }\n            },\n            'js-fundamentals': {\n                1: {\n                    title: 'Variables and Data Types',\n                    description: 'Declare variables using different data types and display them on the webpage.',\n                    requirements: [\n                        'Declare variables using let and const',\n                        'Use string, number, and boolean data types',\n                        'Display variable values in HTML elements',\n                        'Use template literals for string formatting',\n                        'Add console.log statements for debugging'\n                    ],\n                    hints: [\n                        'Use const for values that won\\'t change',\n                        'Template literals use backticks: `Hello ${name}`',\n                        'Use document.getElementById() to update HTML'\n                    ],\n                    example: 'A webpage showing different variable values and types',\n                    starterCode: {\n                        html: '<div id=\"output\">Variables will appear here</div>',\n                        css: '#output { padding: 20px; font-family: Arial; }',\n                        js: '// Declare your variables here\\n// Update the HTML content'\n                    }\n                }\n            },\n            'mini-projects': {\n                1: {\n                    title: 'Personal Portfolio',\n                    description: 'Create a responsive personal portfolio website showcasing your skills and projects.',\n                    requirements: [\n                        'Create a header with navigation menu',\n                        'Add an about section with personal information',\n                        'Include a skills section with your abilities',\n                        'Add a projects section with sample projects',\n                        'Include a contact section with contact information',\n                        'Make the design responsive for mobile devices',\n                        'Use CSS Grid or Flexbox for layout',\n                        'Add smooth scrolling navigation'\n                    ],\n                    hints: [\n                        'Use semantic HTML elements like <header>, <section>, <nav>',\n                        'CSS Grid is great for overall layout, Flexbox for components',\n                        'Use media queries for responsive design',\n                        'Add CSS transitions for smooth interactions'\n                    ],\n                    example: 'A complete portfolio website with multiple sections and responsive design',\n                    starterCode: {\n                        html: '<!DOCTYPE html>\\n<html lang=\"en\">\\n<head>\\n    <meta charset=\"UTF-8\">\\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\\n    <title>My Portfolio</title>\\n</head>\\n<body>\\n    <!-- Build your portfolio here -->\\n</body>\\n</html>',\n                        css: '/* Add your portfolio styles here */',\n                        js: '// Add interactive features here'\n                    }\n                }\n            }\n        };\n        \n        return challengeDetails[this.category]?.[this.challengeId] || this.getDefaultChallenge();\n    }\n    \n    // Get default challenge if not found\n    getDefaultChallenge() {\n        return {\n            title: 'Challenge Not Found',\n            description: 'This challenge is not yet available.',\n            requirements: ['Challenge content coming soon'],\n            hints: ['Check back later for this challenge'],\n            example: 'Challenge preview not available',\n            starterCode: { html: '', css: '', js: '' }\n        };\n    }\n    \n    // Load and display challenge details\n    loadChallengeDetails() {\n        const challenge = this.getChallengeDetails();\n        const allChallenges = this.getAllChallenges();\n        const currentChallenge = allChallenges[this.category]?.find(c => c.id === this.challengeId);\n        \n        if (!currentChallenge) return;\n        \n        // Update header information\n        this.challengeTitle.textContent = challenge.title;\n        this.difficultyBadge.textContent = currentChallenge.difficulty;\n        this.difficultyBadge.className = `difficulty-badge ${currentChallenge.difficulty}`;\n        this.xpBadge.textContent = `+${currentChallenge.xp} XP`;\n        \n        const categoryNames = {\n            'html-basics': 'HTML Basics',\n            'css-styling': 'CSS Styling',\n            'js-fundamentals': 'JavaScript Fundamentals',\n            'mini-projects': 'Mini-Projects'\n        };\n        this.categoryBadge.textContent = categoryNames[this.category];\n        \n        // Update content\n        this.challengeDescription.textContent = challenge.description;\n        \n        // Populate requirements\n        this.requirementsList.innerHTML = challenge.requirements\n            .map(req => `<li>${req}</li>`)\n            .join('');\n        \n        // Set up hints\n        this.hintContent.innerHTML = challenge.hints\n            .map(hint => `<p>${hint}</p>`)\n            .join('');\n        \n        // Set example\n        this.examplePreview.textContent = challenge.example;\n        \n        // Set starter code\n        this.starterHtml.textContent = challenge.starterCode.html;\n        this.starterCss.textContent = challenge.starterCode.css;\n        this.starterJs.textContent = challenge.starterCode.js;\n        \n        // Update progress\n        const totalChallenges = allChallenges[this.category]?.length || 0;\n        this.challengeProgress.textContent = `Challenge ${this.challengeId} of ${totalChallenges}`;\n        \n        // Check if challenge is completed\n        const isCompleted = this.challengeData[this.category]?.includes(this.challengeId);\n        if (isCompleted) {\n            this.startChallengeBtn.textContent = 'Completed âœ“';\n            this.startChallengeBtn.style.background = '#4caf50';\n        }\n    }\n    \n    // Get all challenges (simplified version)\n    getAllChallenges() {\n        return {\n            'html-basics': Array.from({length: 10}, (_, i) => ({ id: i + 1, difficulty: i < 4 ? 'easy' : i < 7 ? 'medium' : 'hard', xp: (i + 1) * 5 + 5 })),\n            'css-styling': Array.from({length: 10}, (_, i) => ({ id: i + 1, difficulty: i < 3 ? 'easy' : i < 7 ? 'medium' : 'hard', xp: (i + 1) * 5 + 5 })),\n            'js-fundamentals': Array.from({length: 10}, (_, i) => ({ id: i + 1, difficulty: i < 4 ? 'easy' : i < 6 ? 'medium' : 'hard', xp: (i + 1) * 5 + 5 })),\n            'mini-projects': Array.from({length: 5}, (_, i) => ({ id: i + 1, difficulty: i < 2 ? 'medium' : 'hard', xp: 100 + i * 20 }))\n        };\n    }\n    \n    // Bind event listeners\n    bindEvents() {\n        // Back to challenges\n        this.backBtn.addEventListener('click', () => {\n            window.location.href = `challenges.html`;\n        });\n        \n        // Show hint\n        this.showHintBtn.addEventListener('click', () => {\n            if (this.hintContent.style.display === 'none') {\n                this.hintContent.style.display = 'block';\n                this.showHintBtn.textContent = 'Hide Hint';\n            } else {\n                this.hintContent.style.display = 'none';\n                this.showHintBtn.textContent = 'Show Hint';\n            }\n        });\n        \n        // Copy starter code\n        this.copyStarterBtn.addEventListener('click', () => {\n            this.copyStarterCode();\n        });\n        \n        // Start challenge\n        this.startChallengeBtn.addEventListener('click', () => {\n            this.startChallenge();\n        });\n        \n        // Skip challenge\n        this.skipChallengeBtn.addEventListener('click', () => {\n            this.skipChallenge();\n        });\n        \n        // Start coding\n        this.startCodingBtn.addEventListener('click', () => {\n            this.startCoding();\n        });\n    }\n    \n    // Copy starter code to clipboard\n    copyStarterCode() {\n        const challenge = this.getChallengeDetails();\n        const code = `HTML:\\n${challenge.starterCode.html}\\n\\nCSS:\\n${challenge.starterCode.css}\\n\\nJavaScript:\\n${challenge.starterCode.js}`;\n        \n        navigator.clipboard.writeText(code).then(() => {\n            this.copyStarterBtn.textContent = 'Copied!';\n            setTimeout(() => {\n                this.copyStarterBtn.textContent = 'Copy Code';\n            }, 2000);\n        });\n    }\n    \n    // Start challenge (mark as completed for now)\n    startChallenge() {\n        if (!this.challengeData[this.category]) {\n            this.challengeData[this.category] = [];\n        }\n        \n        if (!this.challengeData[this.category].includes(this.challengeId)) {\n            this.challengeData[this.category].push(this.challengeId);\n            localStorage.setItem('codequest_challenges', JSON.stringify(this.challengeData));\n            \n            this.startChallengeBtn.textContent = 'Completed âœ“';\n            this.startChallengeBtn.style.background = '#4caf50';\n            \n            this.showCompletionMessage();\n        }\n    }\n    \n    // Skip challenge\n    skipChallenge() {\n        const nextId = this.challengeId + 1;\n        const allChallenges = this.getAllChallenges();\n        const maxChallenges = allChallenges[this.category]?.length || 0;\n        \n        if (nextId <= maxChallenges) {\n            window.location.href = `challenge-detail.html?category=${this.category}&id=${nextId}`;\n        } else {\n            window.location.href = 'challenges.html';\n        }\n    }\n    \n    // Start coding in editor\n    startCoding() {\n        const challenge = this.getChallengeDetails();\n        \n        // Store starter code in localStorage for editor\n        localStorage.setItem('codequest_editor_challenge', JSON.stringify({\n            html: challenge.starterCode.html,\n            css: challenge.starterCode.css,\n            js: challenge.starterCode.js,\n            challengeId: this.challengeId,\n            category: this.category\n        }));\n        \n        window.location.href = 'editor.html';\n    }\n    \n    // Show completion message\n    showCompletionMessage() {\n        const notification = document.createElement('div');\n        notification.innerHTML = `\n            <div style=\"display: flex; align-items: center; gap: 15px;\">\n                <span style=\"font-size: 2rem;\">ðŸŽ‰</span>\n                <div>\n                    <strong>Challenge Started!</strong><br>\n                    <span>Good luck with your coding challenge!</span>\n                </div>\n            </div>\n        `;\n        notification.style.cssText = `\n            position: fixed;\n            top: 20px;\n            right: 20px;\n            background: linear-gradient(135deg, #4CAF50, #66BB6A);\n            color: white;\n            padding: 20px 25px;\n            border-radius: 10px;\n            z-index: 1000;\n            animation: slideIn 0.3s ease;\n            box-shadow: 0 8px 20px rgba(76, 175, 80, 0.3);\n        `;\n        \n        document.body.appendChild(notification);\n        \n        setTimeout(() => {\n            notification.remove();\n        }, 3000);\n    }\n}\n\n// Initialize challenge detail when DOM loads\ndocument.addEventListener('DOMContentLoaded', () => {\n    new ChallengeDetail();\n});